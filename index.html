<!DOCTYPE html>
<html lang="ta">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <meta name="theme-color" content="#000000">
    <meta name="msapplication-TileColor" content="#000000">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>ЁЯПб роХро┐ро░ро╛роо ро╡ро╛роХрпНроХрпБрокрпНрокродро┐ро╡рпБ - Tamil Nadu Village EVM</title>
    <link rel="stylesheet" href="style.css">
    <!-- EmailJS SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script>
        (function() {
            emailjs.init("_ELd3lCtDaNVeUST_");
        })();
    </script>
</head>
<body>
    <!-- Login Screen -->
    <div id="loginScreen" class="login-screen">
        <div class="login-card">
            <div class="login-header">
                <div class="login-icon">ЁЯЧ│я╕П</div>
                <h1>ЁЯФР ро╡ро╛роХрпНроХро╛ро│ро░рпН роЪро░ро┐рокро╛ро░рпНрокрпНрокрпБ</h1>
                <p>родрооро┐ро┤рпНроиро╛роЯрпБ роХро┐ро░ро╛роо ро╡ро╛роХрпНроХрпБрокрпНрокродро┐ро╡рпБ 2026</p>
            </div>
            
            <form id="loginForm">
                <div class="input-group">
                    <label>ЁЯУз рооро┐ройрпНройроЮрпНроЪро▓рпН</label>
                    <input type="email" id="emailInput" placeholder="example@gmail.com" required>
                </div>
                
                <div class="input-group hidden" id="otpGroup">
                    <label>ЁЯФв OTP роХрпБро▒ро┐ропрпАроЯрпБ</label>
                    <div class="otp-input-group">
                        <input type="text" id="otpInput" maxlength="6" placeholder="000000" pattern="[0-9]{6}">
                        <button type="button" id="verifyOtpBtn" class="verify-btn">роЪро░ро┐рокро╛ро░рпН</button>
                    </div>
                    <div class="otp-timer" id="otpTimer">OTP роХро╛ро▓ро╛ро╡родро┐ропро╛роХ 5:00</div>
                </div>
                
                <button type="button" id="sendOtpBtn" class="login-btn">ЁЯУи OTP роЕройрпБрокрпНрокрпБ</button>
                <button type="button" id="loginWithOtpBtn" class="login-btn hidden">ЁЯФУ роЙро│рпНроирпБро┤рпИроХ</button>
            </form>
            
            <div class="login-footer">
                <p>ЁЯФС Admin: admin@evm.com</p>
                <p>ЁЯСе Public: any@gmail.com</p>
                <div class="login-note">
                    <span>тЪая╕П OTP 6 роЗро▓роХрпНроХроЩрпНроХро│рпН</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div id="mainApp" class="main-app hidden">
        <div class="container">
            <!-- Header with Logout Button -->
            <div class="village-header">
                <div class="village-info">
                    <div class="village-icon">ЁЯПб</div>
                    <div class="village-title">
                        <h1>роХро┐ро░ро╛роо ро╡ро╛роХрпНроХрпБрокрпНрокродро┐ро╡рпБ 2026</h1>
                        <p>Village Level Survey - Tamil Nadu Election</p>
                    </div>
                </div>
                <div class="header-actions">
                    <div class="village-stats">
                        <div class="stat-item">
                            <div class="stat-label">роорпКродрпНрод ро╡ро╛роХрпНроХрпБроХро│рпН</div>
                            <div class="stat-number" id="totalVotes">0</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">рокродро┐ро╡рпБ роЪрпЖропрпНродро╡ро░рпНроХро│рпН</div>
                            <div class="stat-number" id="votersCount">10</div>
                        </div>
                    </div>
                    <button class="logout-btn" onclick="villageEVM.logout()">
                        <span>ЁЯЪк</span> ро╡рпЖро│ро┐ропрпЗро▒рпБ
                    </button>
                </div>
            </div>

            <!-- Village Info with User Type -->
            <div class="village-card">
                <div class="village-detail">
                    <span>ЁЯУН</span>
                    <span id="villageName">роХрпБрогроороЩрпНроХро▓роорпН</span>
                </div>
                <div class="village-detail">
                    <span>ЁЯЧ│я╕П</span>
                    <span id="boothNumber">ро╡ро╛роХрпНроХрпБроЪрпНроЪро╛ро╡роЯро┐: TN-15-157-158</span>
                </div>
                <div class="village-detail">
                    <span>ЁЯСе</span>
                    <span id="surveyorName">роХрогроХрпНроХрпЖроЯрпБрокрпНрокро╛ро│ро░рпН: роХрпБрогроороЩрпНроХро▓роорпН TVK</span>
                </div>
                <div class="village-detail" id="userEmailDisplay">
                    <span>ЁЯУз</span>
                    <span id="userEmail"></span>
                    <span id="userRoleBadge" class="role-badge"></span>
                </div>
            </div>

            <!-- Tab Navigation -->
            <div class="tab-navigation">
                <button class="tab-btn active" onclick="villageEVM.switchTab('vote')" id="tabVoteBtn">
                    <span>ЁЯЧ│я╕П</span> ро╡ро╛роХрпНроХро│ро┐
                </button>
                <button class="tab-btn" onclick="villageEVM.switchTab('suggestions')" id="tabSuggestBtn">
                    <span>ЁЯТб</span> роХрпЛро░ро┐роХрпНроХрпИроХро│рпН
                </button>
                <button class="tab-btn admin-only hidden" onclick="villageEVM.switchTab('results')" id="tabResultsBtn">
                    <span>ЁЯУК</span> роорпБроЯро┐ро╡рпБроХро│рпН
                </button>
                <button class="tab-btn admin-only hidden" onclick="villageEVM.showAdminDashboard()" id="tabAdminBtn">
                    <span>тЪЩя╕П</span> роиро┐ро░рпНро╡ро╛роХроорпН
                </button>
            </div>

            <!-- VOTE TAB (Visible to all) -->
            <div id="voteTab" class="tab-content active">
                <div class="survey-panel">
                    <div class="survey-header">
                        <h2><span>ЁЯЧ│я╕П</span> роЙроЩрпНроХро│рпН ро╡ро╛роХрпНроХрпИ рокродро┐ро╡рпБ роЪрпЖропрпНропрпБроЩрпНроХро│рпН</h2>
                        <div id="timerDisplay" class="vote-timer hidden">
                            <span>тП│</span>
                            <span id="timerValue">2</span> ро╡ро┐ройро╛роЯро┐роХро│рпН
                        </div>
                    </div>

                    <div class="search-box">
                        <input type="text" id="searchInput" class="search-input" placeholder="ЁЯФН роХроЯрпНроЪро┐ рокрпЖропро░рпН родрпЗроЯрпБроХ...">
                        <select id="allianceFilter" class="filter-select" 
                            title="роХроЯрпНроЪро┐ роХрпВроЯрпНроЯрогро┐ роорпВро▓роорпН ро╡роЯро┐роХроЯрпНроЯрпБ"
                            aria-label="роХроЯрпНроЪро┐ роХрпВроЯрпНроЯрогро┐ роорпВро▓роорпН ро╡роЯро┐роХроЯрпНроЯрпБ">
                            <option value="all">роЕройрпИродрпНродрпБ роХроЯрпНроЪро┐роХро│рпН</option>
                            <option value="SECULAR">роородроЪрпНроЪро╛ро░рпНрокро▒рпНро▒ роорпБройрпНройрогро┐</option>
                            <option value="NDA">родрпЗроЪро┐роп роЬройроиро╛ропроХ роХрпВроЯрпНроЯрогро┐</option>
                            <option value="Left">роЗроЯродрпБ роорпБройрпНройрогро┐</option>
                            <option value="Others">рокро┐ро▒ роХроЯрпНроЪро┐роХро│рпН</option>
                        </select>
                    </div>

                    <div id="partyGrid" class="party-grid"></div>

                    <p class="text-center instruction-text">
                        <span class="instruction-badge">ЁЯСЖ роХроЯрпНроЪро┐ роорпЗро▓рпН роХро┐ро│ро┐роХрпН роЪрпЖропрпНродрпБ ро╡ро╛роХрпНроХро│ро┐роХрпНроХро╡рпБроорпН</span>
                    </p>
                </div>
            </div>

            <!-- SUGGESTIONS TAB (Visible to all) -->
            <div id="suggestionsTab" class="tab-content hidden">
                <div class="survey-panel">
                    <div class="survey-header">
                        <h2><span>ЁЯТб</span> роороХрпНроХро│ро┐ройрпН роХрпЛро░ро┐роХрпНроХрпИроХро│рпН</h2>
                    </div>

                    <!-- Add Suggestion Form -->
                    <div class="suggestion-form">
                        <h3>ЁЯУЭ рокрпБродро┐роп роХрпЛро░ро┐роХрпНроХрпИ</h3>
                        <input type="text" id="suggestionTitle" class="search-input" placeholder="родро▓рпИрокрпНрокрпБ (роО.роХро╛: рокрпБродро┐роп роЪро╛ро▓рпИ)" maxlength="100">
                        <textarea id="suggestionDesc" class="suggestion-textarea" placeholder="ро╡ро┐ро╡ро░роорпН..." rows="3" maxlength="500"></textarea>
                        <input type="text" id="suggesterName" class="search-input" placeholder="роЙроЩрпНроХро│рпН рокрпЖропро░рпН (ро╡ро┐ро░рпБроорпНрокро┐ройро╛ро▓рпН)">
                        <button class="submit-suggestion-btn" onclick="villageEVM.addSuggestion()">
                            <span>ЁЯУд</span> роХрпЛро░ро┐роХрпНроХрпИ роЪрооро░рпНрокрпНрокро┐
                        </button>
                    </div>

                    <!-- Suggestions List -->
                    <div class="suggestions-list">
                        <h3>ЁЯУЛ роЕрогрпНроорпИроп роХрпЛро░ро┐роХрпНроХрпИроХро│рпН</h3>
                        <div id="suggestionsContainer" class="suggestions-container">
                            <!-- Suggestions will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- RESULTS TAB (ADMIN ONLY) -->
            <div id="resultsTab" class="tab-content hidden">
                <div class="results-section">
                    <div class="results-header">
                        <h3><span>ЁЯУК</span> роирпЗро░роЯро┐ роорпБроЯро┐ро╡рпБроХро│рпН - роХрпБрогроороЩрпНроХро▓роорпН</h3>
                        <button class="reset-btn admin-only" onclick="villageEVM.resetVotes()">
                            <span>ЁЯФД</span> роорпАроЯрпНроЯроорпИ
                        </button>
                    </div>

                    <div class="table-container">
                        <table class="results-table">
                            <thead>
                                <tr>
                                    <th>родро░роорпН</th>
                                    <th>роЪро┐ройрпНройроорпН</th>
                                    <th>роХроЯрпНроЪро┐</th>
                                    <th>родрооро┐ро┤рпН рокрпЖропро░рпН</th>
                                    <th>ро╡ро╛роХрпНроХрпБроХро│рпН</th>
                                    <th>%</th>
                                </tr>
                            </thead>
                            <tbody id="resultsBody"></tbody>
                        </table>
                    </div>

                    <div class="total-votes-footer">
                        <span class="total-votes-text">роорпКродрпНрод ро╡ро╛роХрпНроХрпБроХро│рпН: <span id="totalVotesFooter">0</span></span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Modal -->
    <div id="adminModal" class="modal" style="display: none;">
        <div class="modal-content admin-modal-content">
            <div class="modal-header">
                <h2>тЪЩя╕П роиро┐ро░рпНро╡ро╛роХ роХроЯрпНроЯрпБрокрпНрокро╛роЯрпНроЯрпБ рокро▓роХроорпН</h2>
                <button class="close-modal" onclick="document.getElementById('adminModal').style.display='none'">&times;</button>
            </div>
            <div id="adminModalBody" class="modal-body">
                <!-- Admin content will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirmModal" class="modal">
        <div class="modal-content">
            <h3>тЬЕ ро╡ро╛роХрпНроХрпБ роЙро▒рпБродро┐рокрпНрокроЯрпБродрпНродро▓рпН</h3>
            <div id="modalPartySymbol" class="modal-party"></div>
            <div id="modalPartyName" class="modal-party-name"></div>
            <div id="modalPartyTamil" class="modal-party-tamil"></div>
            <div class="confirmation-container">
                <span class="confirmation-text">роЗроирпНрод роХроЯрпНроЪро┐роХрпНроХрпБ ро╡ро╛роХрпНроХро│ро┐роХрпНроХ роЙро▒рпБродро┐ропро╛?</span>
            </div>
            <div class="modal-buttons">
                <button onclick="villageEVM.confirmVote()" class="confirm-btn">роЖроорпН, ро╡ро╛роХрпНроХро│ро┐</button>
                <button onclick="villageEVM.cancelVote()" class="cancel-btn">роЗро▓рпНро▓рпИ, ро░родрпНродрпБ</button>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div id="toast" class="toast"></div>

    <script src="script.js"></script>
</body>
</html>